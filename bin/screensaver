#!/usr/bin/env bash

if [ "$1" = "notify" ]; then
	# notify-send help says timeout is in milliseconds
	# but it appears that it is really in seconds (is it a dunst bug?)
	[ $2 -gt 1 ] && notify-send -t $[$2-1] "Activating screensaver in $2 seconds..."
else
	killall -USR1 dunst
	slock &
	slock_pid=$!
	# for xautolock -unlocknow
	trap "killall -USR2 dunst; kill $slock_pid" EXIT
	wait $slock_pid
fi
